{"version":3,"sources":["webpack:///./src/views/Squeezenet.vue?da07","webpack:///src/views/Squeezenet.vue","webpack:///./src/views/Squeezenet.vue?22bd","webpack:///./src/views/Squeezenet.vue","webpack:///./src/views/Squeezenet.vue?9a0e"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","style","width","ref","attrs","items","on","select","upload","height","canRun","run","_s","Math","round","output","time","predictions","label","score","_l","slice","pred","i","key","_e","staticRenderFns","rURL","src","window","location","href","replace","drawImage","canvas","img","onload","ctx","getData","index","datum","means","stds","softmax","logits","exp","map","getTopK","preds","k","indices","sort","name","data","text","value","computed","model","labels","length","methods","file","URL","createObjectURL","$refs","internalValue","url","predict","component","VBtn","VCard","VCol","VContainer","VFileInput","VRow","VSelect"],"mappings":"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","file":"js/squeezenet.65a07e94.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"d-flex flex-column\"},[_c('h1',{staticClass:\"headline\"},[_vm._v(\"SqueezeNet Inference\")]),_c('div',{staticClass:\"d-flex justify-center flex-wrap\"},[_c('div',{staticClass:\"ma-4 d-flex flex-column justify-space-around\",style:({ width: _vm.width + 'px'})},[_c('v-select',{ref:\"select\",staticClass:\"pa-0 shrink\",attrs:{\"hide-details\":\"\",\"label\":\"Select image\",\"items\":_vm.items,\"prepend-icon\":\"mdi-image\"},on:{\"change\":_vm.select}}),_c('p',{staticClass:\"mx-0 ma-4 mb-2 overline align-self-center\"},[_vm._v(\"- or -\")]),_c('v-file-input',{ref:\"upload\",staticClass:\"pa-0 shrink\",attrs:{\"hide-details\":\"\",\"label\":\"Upload image\"},on:{\"change\":_vm.upload}})],1),_c('v-card',{staticClass:\"mx-2\",attrs:{\"height\":_vm.height}},[_c('canvas',{ref:\"canvas\",attrs:{\"height\":_vm.height,\"width\":_vm.width}})])],1),_c('v-btn',{staticClass:\"ma-8 align-self-center\",attrs:{\"disabled\":!_vm.canRun,\"color\":\"primary\",\"x-large\":\"\"},on:{\"click\":_vm.run}},[_vm._v(\"Predict\")]),(_vm.output)?_c('v-container',{staticClass:\"shrink align-self-center\",attrs:{\"fluid\":\"\"}},[_c('v-row',[_c('v-col',{staticClass:\"body-1 font-weight-bold\"},[_vm._v(\"Inference time:\")]),_c('v-col',{staticClass:\"text-right font-weight-regular\"},[_vm._v(_vm._s(Math.round(_vm.output.time))+\"ms\")])],1),_c('v-row',[_c('v-col',[_c('p',{staticClass:\"body-1 font-weight-bold ma-0\"},[_vm._v(\"Predictions:\")])]),_c('v-col',{staticClass:\"text-right\"},[_vm._v(_vm._s(_vm.output.predictions[0].label)+\": \"+_vm._s(Math.round(_vm.output.predictions[0].score*100))+\"%\")])],1),_vm._l((_vm.output.predictions.slice(1)),function(pred,i){return _c('v-row',{key:i},[_c('v-col'),_c('v-col',{staticClass:\"text-right\"},[_vm._v(_vm._s(pred.label)+\": \"+_vm._s(Math.round(pred.score*100))+\"%\")])],1)})],2):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"d-flex flex-column\">\n    <h1 class=\"headline\">SqueezeNet Inference</h1>\n    <div class=\"d-flex justify-center flex-wrap\">\n      <div class=\"ma-4 d-flex flex-column justify-space-around\" :style=\"{ width: width + 'px'}\">\n        <v-select\n          @change=\"select\"\n          ref=\"select\"\n          class=\"pa-0 shrink\"\n          hide-details\n          label=\"Select image\"\n          :items=\"items\"\n          prepend-icon=\"mdi-image\"\n        />\n        <p class=\"mx-0 ma-4 mb-2 overline align-self-center\">- or -</p>\n        <v-file-input\n          @change=\"upload\"\n          ref=\"upload\"\n          class=\"pa-0 shrink\"\n          hide-details\n          label=\"Upload image\"\n        />\n      </div>\n      <v-card :height=\"height\" class=\"mx-2\">\n        <canvas ref=\"canvas\" :height=\"height\" :width=\"width\"></canvas>\n      </v-card>\n    </div>\n    <v-btn\n      :disabled=\"!canRun\"\n      @click=\"run\"\n      color=\"primary\"\n      class=\"ma-8 align-self-center\"\n      x-large\n    >Predict</v-btn>\n    <v-container v-if=\"output\" class=\"shrink align-self-center\" fluid>\n      <v-row>\n        <v-col class=\"body-1 font-weight-bold\">Inference time:</v-col>\n        <v-col class=\"text-right font-weight-regular\">{{Math.round(output.time)}}ms</v-col>\n      </v-row>\n      <v-row>\n        <v-col>\n          <p class=\"body-1 font-weight-bold ma-0\">Predictions:</p>\n        </v-col>\n        <v-col\n          class=\"text-right\"\n        >{{output.predictions[0].label}}: {{Math.round(output.predictions[0].score*100)}}%</v-col>\n      </v-row>\n      <v-row v-for=\"(pred, i) in output.predictions.slice(1)\" :key=\"i\">\n        <v-col></v-col>\n        <v-col class=\"text-right\">{{pred.label}}: {{Math.round(pred.score*100)}}%</v-col>\n      </v-row>\n    </v-container>\n  </div>\n</template>\n\n<script>\nimport * as tractjs from \"tractjs\";\n\nfunction rURL(src) {\n  // this makes sure it works both locally and on gh-pages\n  return window.location.href.replace(/\\/$/, \"\") + \"/\" + src;\n}\n\nfunction drawImage(src, canvas) {\n  const img = new Image();\n  img.src = src;\n\n  img.onload = () => {\n    const ctx = canvas.getContext(\"2d\");\n\n    ctx.drawImage(\n      img,\n      0,\n      0,\n      img.width,\n      img.height,\n      0,\n      0,\n      canvas.width,\n      canvas.height\n    );\n  };\n}\n\nfunction getData(canvas) {\n  const ctx = canvas.getContext(\"2d\");\n  const data = ctx.getImageData(0, 0, canvas.width, canvas.height).data;\n\n  const means = [0.485, 0.456, 0.406];\n  const stds = [0.229, 0.224, 0.225];\n  const nPixels = data.length / 4;\n\n  const output = new Float32Array(nPixels * 3);\n  let index = 0;\n\n  for (let i = 0; i < 3; i++) {\n    // channels\n    for (let j = 0; j < canvas.height; j++) {\n      // height\n      for (let k = 0; k < canvas.width; k++) {\n        // width\n        let datum = data[(j * canvas.width + k) * 4 + i];\n        output[index] = (datum / 255 - means[i]) / stds[i];\n        index++;\n      }\n    }\n  }\n\n  return [output, [1, 3, canvas.height, canvas.width]];\n}\n\nfunction softmax(logits) {\n  const exp = logits.map(x => Math.exp(x));\n  const sum = exp.reduce((a, b) => a + b, 0);\n\n  return exp.map(x => x / sum);\n}\n\nfunction getTopK(preds, k) {\n  let indices = Array.from(preds).map((x, i) => [x, i]);\n  indices.sort((a, b) => b[0] - a[0]);\n\n  return indices.slice(0, k);\n}\n\nexport default {\n  name: \"SqueezenetDemo\",\n  data: () => ({\n    width: 224,\n    height: 224,\n    k: 5,\n    items: [\n      {\n        text: \"Cat\",\n        value: rURL(\"cat.png\")\n      },\n      {\n        text: \"Dog\",\n        value: rURL(\"dog.png\")\n      },\n      {\n        text: \"Cheetah\",\n        value: rURL(\"cheetah.png\")\n      },\n      {\n        text: \"Bird\",\n        value: rURL(\"bird.png\")\n      }\n    ],\n    output: null,\n    model: null,\n    labels: []\n  }),\n  computed: {\n    canRun() {\n      return this.model !== null && this.labels.length > 0;\n    }\n  },\n  async created() {\n    this.model = await new tractjs.Model(rURL(\"squeezenet1_1.onnx\"));\n\n    const response = await fetch(rURL(\"synset.txt\"));\n    if (response.status < 200 && response.status >= 300) {\n      return;\n    }\n    const text = await response.text();\n\n    text.split(\"\\n\").forEach(line => {\n      if (line.trim().length == 0) {\n        return;\n      }\n\n      let label = line\n        .split(\" \")\n        .slice(1)\n        .join(\" \")\n        .split(\",\")[0];\n      this.labels.push(label);\n    });\n  },\n  methods: {\n    upload(file) {\n      if (file !== null) {\n        drawImage(URL.createObjectURL(file), this.$refs.canvas);\n        this.$refs.select.internalValue = null;\n      }\n    },\n    select(url) {\n      if (url !== null) {\n        this.$refs.upload.internalValue = null;\n        drawImage(url, this.$refs.canvas);\n      }\n    },\n    predict(input, shape) {\n      let inputTensor = new tractjs.Tensor(input, shape);\n      let outputTensor = this.model.predict(inputTensor);\n\n      let preds = softmax(outputTensor.data());\n      return preds;\n    },\n    async run() {\n      const [input, shape] = getData(this.$refs.canvas);\n\n      let startTime = performance.now();\n      const preds = await this.predict(input, shape);\n      let endTime = performance.now();\n\n      const topK = getTopK(preds, this.k);\n      this.output = {\n        time: endTime - startTime,\n        predictions: topK.map(([score, index]) => ({\n          label: this.labels[index],\n          score\n        }))\n      };\n    }\n  }\n};\n</script>\n\n<style scoped lang=\"scss\">\n.container {\n  max-width: 30rem;\n\n  .col {\n    padding: 0.1em;\n  }\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Squeezenet.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Squeezenet.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Squeezenet.vue?vue&type=template&id=3228ad32&scoped=true&\"\nimport script from \"./Squeezenet.vue?vue&type=script&lang=js&\"\nexport * from \"./Squeezenet.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Squeezenet.vue?vue&type=style&index=0&id=3228ad32&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3228ad32\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VFileInput } from 'vuetify/lib/components/VFileInput';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\ninstallComponents(component, {VBtn,VCard,VCol,VContainer,VFileInput,VRow,VSelect})\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Squeezenet.vue?vue&type=style&index=0&id=3228ad32&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Squeezenet.vue?vue&type=style&index=0&id=3228ad32&scoped=true&lang=scss&\""],"sourceRoot":""}